FROM docker:git
LABEL org.opencontainers.image.authors="zqh"
ARG VERSION=11
WORKDIR /app
# 设置阿里云镜像仓库
RUN sed -i 's/dl-cdn.alpinelinux.org/mirrors.aliyun.com/g' /etc/apk/repositories
RUN apk update

# 安装jdk
RUN apk add openjdk$VERSION
# 安装sshpass
RUN apk add sshpass

# 创建目录
RUN mkdir -p /root/.docker/
RUN mkdir /root/.ssh && touch /root/.ssh/known_hosts
COPY id_rsa /root/.ssh/id_rsa
# Permissions 0755 for '/root/.ssh/id_rsa' are too open
RUN chmod 700 ~/.ssh
RUN chmod 600 /root/.ssh/id_rsa

COPY config.json /root/.docker/config.json

RUN apk cache clean
COPY dockerDelete.sh /app/
